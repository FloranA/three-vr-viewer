!function e(t,r,i){function n(o,a){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){var r=t[o][1][e];return n(r?r:e)},h,h.exports,e,t,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function s(){function e(){var r=U.getDelta();q.requestAnimationFrame(e),C.update(),z.update(),A.update(),M.emit("tick",r),t(),M.emit("render",r)}function t(){q.render(P,S)}function r(){q.isPresenting?q.exitPresent():q.requestPresent()}var i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=i.emptyRoom,s=void 0===n||n,o=i.standing,l=void 0===o||o,h=i.loadControllers,u=void 0===h||h,c=i.vrButton,p=void 0===c||c,v=i.autoEnter,f=void 0!==v&&v,m=i.antiAlias,g=void 0===m||m,y=i.clearColor,E=void 0===y?5263440:y,w=i.pathToControllers,x=void 0===w?"models/obj/vive-controller/":w,b=i.controllerModelName,R=void 0===b?"vr_controller_vive_1_5.obj":b,_=i.controllerTextureMap,T=void 0===_?"onepointfive_texture.png":_,V=i.controllerSpecMap,L=void 0===V?"onepointfive_spec.png":V;d.default.isLatestAvailable()===!1&&document.body.appendChild(d.default.getMessage());var M=new a.default,H=document.createElement("div");document.body.appendChild(H);var P=new THREE.Scene,S=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,10);if(P.add(S),s){var j=new THREE.Mesh(new THREE.BoxGeometry(6,6,6,8,8,8),new THREE.MeshBasicMaterial({color:4210752,wireframe:!0}));j.position.y=3,P.add(j),P.add(new THREE.HemisphereLight(6316128,4210752));var F=new THREE.DirectionalLight(16777215);F.position.set(1,1,1).normalize(),P.add(F)}var D=new THREE.WebGLRenderer({antialias:g});D.setClearColor(E),D.setPixelRatio(window.devicePixelRatio),D.setSize(window.innerWidth,window.innerHeight),D.sortObjects=!1,H.appendChild(D.domElement);var A=new THREE.VRControls(S);A.standing=l;var C=new THREE.ViveController(0),z=new THREE.ViveController(1);if(P.add(C,z),u){C.standingMatrix=A.getStandingMatrix(),z.standingMatrix=A.getStandingMatrix();var O=new THREE.OBJLoader;O.setPath(x),O.load(R,function(e){var t=new THREE.TextureLoader;t.setPath(x);var r=e.children[0];r.material.map=t.load(T),r.material.specularMap=t.load(L),C.add(e.clone()),z.add(e.clone())})}var q=new THREE.VREffect(D);d.default.isAvailable()===!0&&(p&&document.body.appendChild(d.default.getButton(q)),f&&setTimeout(function(){return q.requestPresent()},1e3)),window.addEventListener("resize",function(){S.aspect=window.innerWidth/window.innerHeight,S.updateProjectionMatrix(),q.setSize(window.innerWidth,window.innerHeight),M.emit("resize",window.innerWidth,window.innerHeight)},!1);var U=new THREE.Clock;return U.start(),e(),{scene:P,camera:S,controls:A,renderer:D,controllers:[C,z],events:M,toggleVR:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=s;var o=e("events"),a=n(o),l=e("./thirdparty/webvr"),d=n(l),h=e("./thirdparty/vreffect"),u=(i(h),e("./thirdparty/vrcontrols")),c=(i(u),e("./thirdparty/vivecontroller")),p=(i(c),e("./thirdparty/objloader"));i(p);window&&(window.VRViewer=s)},{"./thirdparty/objloader":3,"./thirdparty/vivecontroller":4,"./thirdparty/vrcontrols":5,"./thirdparty/vreffect":6,"./thirdparty/webvr":7,events:2}],2:[function(e,t,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,r,i,s,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(r=this._events[e],a(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(o(r))for(s=Array.prototype.slice.call(arguments,1),d=r.slice(),i=d.length,l=0;l<i;l++)d[l].apply(this,s);return!0},i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},i.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,r){"use strict";THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,normal_pattern:/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,uv_pattern:/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,r,i){var n=this,s=new THREE.XHRLoader(n.manager);s.setPath(this.path),s.load(e,function(e){t(n.parse(e))},r,i)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},_createParserState:function(){var e={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1)return this.object.name=e,void(this.object.fromDeclaration=t!==!1);this.object&&"function"==typeof this.object._finalize&&this.object._finalize();var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var i={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){return{index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:this.groupEnd,groupEnd:-1,groupCount:-1,inherited:!1}}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();return t&&t.groupEnd===-1&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e!==!1&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize()},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var i=this.vertices,n=this.object.geometry.vertices;n.push(i[e+0]),n.push(i[e+1]),n.push(i[e+2]),n.push(i[t+0]),n.push(i[t+1]),n.push(i[t+2]),n.push(i[r+0]),n.push(i[r+1]),n.push(i[r+2])},addVertexLine:function(e){var t=this.vertices,r=this.object.geometry.vertices;r.push(t[e+0]),r.push(t[e+1]),r.push(t[e+2])},addNormal:function(e,t,r){var i=this.normals,n=this.object.geometry.normals;n.push(i[e+0]),n.push(i[e+1]),n.push(i[e+2]),n.push(i[t+0]),n.push(i[t+1]),n.push(i[t+2]),n.push(i[r+0]),n.push(i[r+1]),n.push(i[r+2])},addUV:function(e,t,r){var i=this.uvs,n=this.object.geometry.uvs;n.push(i[e+0]),n.push(i[e+1]),n.push(i[t+0]),n.push(i[t+1]),n.push(i[r+0]),n.push(i[r+1])},addUVLine:function(e){var t=this.uvs,r=this.object.geometry.uvs;r.push(t[e+0]),r.push(t[e+1])},addFace:function(e,t,r,i,n,s,o,a,l,d,h,u){var c,p=this.vertices.length,v=this.parseVertexIndex(e,p),f=this.parseVertexIndex(t,p),m=this.parseVertexIndex(r,p);if(void 0===i?this.addVertex(v,f,m):(c=this.parseVertexIndex(i,p),this.addVertex(v,f,c),this.addVertex(f,m,c)),void 0!==n){var g=this.uvs.length;v=this.parseUVIndex(n,g),f=this.parseUVIndex(s,g),m=this.parseUVIndex(o,g),void 0===i?this.addUV(v,f,m):(c=this.parseUVIndex(a,g),this.addUV(v,f,c),this.addUV(f,m,c))}if(void 0!==l){var y=this.normals.length;v=this.parseNormalIndex(l,y),f=l===d?v:this.parseNormalIndex(d,y),m=l===h?v:this.parseNormalIndex(h,y),void 0===i?this.addNormal(v,f,m):(c=this.parseNormalIndex(u,y),this.addNormal(v,f,c),this.addNormal(f,m,c))}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,i=this.uvs.length,n=0,s=e.length;n<s;n++)this.addVertexLine(this.parseVertexIndex(e[n],r));for(var o=0,s=t.length;o<s;o++)this.addUVLine(this.parseUVIndex(t[o],i))}};return e.startObject("",!1),e},parse:function(e){console.time("OBJLoader");var t=this._createParserState();e.indexOf("\r\n")!==-1&&(e=e.replace("\r\n","\n"));for(var r=e.split("\n"),i="",n="",s="",o=0,a=[],l="function"==typeof"".trimLeft,d=0,h=r.length;d<h;d++)if(i=r[d],i=l?i.trimLeft():i.trim(),o=i.length,0!==o&&(n=i.charAt(0),"#"!==n))if("v"===n)if(s=i.charAt(1)," "===s&&null!==(a=this.regexp.vertex_pattern.exec(i)))t.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else if("n"===s&&null!==(a=this.regexp.normal_pattern.exec(i)))t.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else{if("t"!==s||null===(a=this.regexp.uv_pattern.exec(i)))throw new Error("Unexpected vertex/normal/uv line: '"+i+"'");t.uvs.push(parseFloat(a[1]),parseFloat(a[2]))}else if("f"===n)if(null!==(a=this.regexp.face_vertex_uv_normal.exec(i)))t.addFace(a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],a[3],a[6],a[9],a[12]);else if(null!==(a=this.regexp.face_vertex_uv.exec(i)))t.addFace(a[1],a[3],a[5],a[7],a[2],a[4],a[6],a[8]);else if(null!==(a=this.regexp.face_vertex_normal.exec(i)))t.addFace(a[1],a[3],a[5],a[7],void 0,void 0,void 0,void 0,a[2],a[4],a[6],a[8]);else{if(null===(a=this.regexp.face_vertex.exec(i)))throw new Error("Unexpected face line: '"+i+"'");t.addFace(a[1],a[2],a[3],a[4])}else if("l"===n){var u=i.substring(1).trim().split(" "),c=[],p=[];if(i.indexOf("/")===-1)c=u;else for(var v=0,f=u.length;v<f;v++){var m=u[v].split("/");""!==m[0]&&c.push(m[0]),""!==m[1]&&p.push(m[1])}t.addLineGeometry(c,p)}else if(null!==(a=this.regexp.object_pattern.exec(i))){var g=a[0].substr(1).trim();t.startObject(g)}else if(this.regexp.material_use_pattern.test(i))t.object.startMaterial(i.substring(7).trim(),t.materialLibraries);else if(this.regexp.material_library_pattern.test(i))t.materialLibraries.push(i.substring(7).trim());else{if(null===(a=this.regexp.smoothing_pattern.exec(i))){if("\0"===i)continue;throw new Error("Unexpected line: '"+i+"'")}var y=a[1].trim().toLowerCase();t.object.smooth="1"===y||"on"===y;var E=t.object.currentMaterial();E&&(E.smooth=t.object.smooth)}t.finalize();var w=new THREE.Group;w.materialLibraries=[].concat(t.materialLibraries);for(var d=0,h=t.objects.length;d<h;d++){var x=t.objects[d],b=x.geometry,R=x.materials,_="Line"===b.type;if(0!==b.vertices.length){var T=new THREE.BufferGeometry;T.addAttribute("position",new THREE.BufferAttribute(new Float32Array(b.vertices),3)),b.normals.length>0?T.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(b.normals),3)):T.computeVertexNormals(),b.uvs.length>0&&T.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(b.uvs),2));for(var V=[],L=0,M=R.length;L<M;L++){var H=R[L],E=void 0;if(null!==this.materials&&(E=this.materials.create(H.name),_&&E&&!(E instanceof THREE.LineBasicMaterial))){var P=new THREE.LineBasicMaterial;P.copy(E),E=P}E||(E=_?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial,E.name=H.name),E.shading=H.smooth?THREE.SmoothShading:THREE.FlatShading,V.push(E)}var S;if(V.length>1){for(var L=0,M=R.length;L<M;L++){var H=R[L];T.addGroup(H.groupStart,H.groupCount,L)}var j=new THREE.MultiMaterial(V);S=_?new THREE.LineSegments(T,j):new THREE.Mesh(T,j)}else S=_?new THREE.LineSegments(T,V[0]):new THREE.Mesh(T,V[0]);S.name=x.name,w.add(S)}}return console.timeEnd("OBJLoader"),w}}},{}],4:[function(e,t,r){"use strict";THREE.ViveController=function(e){function t(e){for(var t=navigator.getGamepads(),r=0,i=0;r<4;r++){var n=t[r];if(n&&"OpenVR Gamepad"===n.id){if(i===e)return n;i++}}}THREE.Object3D.call(this);var r,i=this,n=[0,0],s=!1,o=!1,a=!1,l=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new THREE.Matrix4,this.getGamepad=function(){return r},this.getButtonState=function(e){return"thumbpad"===e?s:"trigger"===e?o:"grips"===e?a:"menu"===e?l:void 0},this.update=function(){if(r=t(e),void 0!==r&&null!==r.pose){var d=r.pose;null!==d.position&&i.position.fromArray(d.position),null!==d.orientation&&i.quaternion.fromArray(d.orientation),i.matrix.compose(i.position,i.quaternion,i.scale),i.matrix.multiplyMatrices(i.standingMatrix,i.matrix),i.matrixWorldNeedsUpdate=!0,i.visible=!0,n[0]===r.axes[0]&&n[1]===r.axes[1]||(n[0]=r.axes[0],n[1]=r.axes[1],i.dispatchEvent({type:"axischanged",axes:n})),s!==r.buttons[0].pressed&&(s=r.buttons[0].pressed,i.dispatchEvent({type:s?"thumbpaddown":"thumbpadup"})),o!==r.buttons[1].pressed&&(o=r.buttons[1].pressed,i.dispatchEvent({type:o?"triggerdown":"triggerup"})),a!==r.buttons[2].pressed&&(a=r.buttons[2].pressed,i.dispatchEvent({type:a?"gripsdown":"gripsup"})),l!==r.buttons[3].pressed&&(l=r.buttons[3].pressed,i.dispatchEvent({type:l?"menudown":"menuup"}))}else i.visible=!1}},THREE.ViveController.prototype=Object.create(THREE.Object3D.prototype),THREE.ViveController.prototype.constructor=THREE.ViveController},{}],5:[function(e,t,r){"use strict";THREE.VRControls=function(e,t){function r(e){n=e;for(var r=0;r<e.length;r++)if("VRDisplay"in window&&e[r]instanceof VRDisplay||"PositionSensorVRDevice"in window&&e[r]instanceof PositionSensorVRDevice){i=e[r];break}void 0===i&&t&&t("VR input not available.")}var i,n,s=this,o=new THREE.Matrix4;navigator.getVRDisplays?navigator.getVRDisplays().then(r):navigator.getVRDevices&&navigator.getVRDevices().then(r),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return i},this.getVRDisplays=function(){return n},this.getStandingMatrix=function(){return o},this.update=function(){if(i){if(i.getPose){var t=i.getPose();null!==t.orientation&&e.quaternion.fromArray(t.orientation),null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0)}else{var r=i.getState();null!==r.orientation&&e.quaternion.copy(r.orientation),null!==r.position?e.position.copy(r.position):e.position.set(0,0,0)}this.standing&&(i.stageParameters?(e.updateMatrix(),o.fromArray(i.stageParameters.sittingToStandingTransform),e.applyMatrix(o)):e.position.setY(e.position.y+this.userHeight)),e.position.multiplyScalar(s.scale)}},this.resetPose=function(){i&&(void 0!==i.resetPose?i.resetPose():void 0!==i.resetSensor?i.resetSensor():void 0!==i.zeroSensor&&i.zeroSensor())},this.resetSensor=function(){console.warn("THREE.VRControls: .resetSensor() is now .resetPose()."),this.resetPose()},this.zeroSensor=function(){console.warn("THREE.VRControls: .zeroSensor() is now .resetPose()."),this.resetPose()},this.dispose=function(){i=null}}},{}],6:[function(e,t,r){"use strict";THREE.VREffect=function(e,t){function r(e){l=e;for(var r=0;r<e.length;r++){if("VRDisplay"in window&&e[r]instanceof VRDisplay){a=e[r],p=!0;break}if("HMDVRDevice"in window&&e[r]instanceof HMDVRDevice){a=e[r],p=!1;break}}void 0===a&&t&&t("HMD not available")}function i(){var t=m.isPresenting;if(m.isPresenting=void 0!==a&&(a.isPresenting||!p&&document[x]instanceof window.HTMLElement),m.isPresenting){var r,i,n=a.getEyeParameters("left");if(p){if(r=n.renderWidth,i=n.renderHeight,a.getLayers){var s=a.getLayers();s.length&&(R=s[0].leftBounds||[0,0,.5,1],_=s[0].rightBounds||[.5,0,.5,1])}}else r=n.renderRect.width,i=n.renderRect.height;t||(y=e.getPixelRatio(),g=e.getSize(),e.setPixelRatio(1),e.setSize(2*r,i,!1))}else t&&(e.setPixelRatio(y),e.setSize(g.width,g.height))}function n(e){var t=2/(e.leftTan+e.rightTan),r=(e.leftTan-e.rightTan)*t*.5,i=2/(e.upTan+e.downTan),n=(e.upTan-e.downTan)*i*.5;return{scale:[t,i],offset:[r,n]}}function s(e,t,r,i){t=void 0===t||t,r=void 0===r?.01:r,i=void 0===i?1e4:i;var s=t?-1:1,o=new THREE.Matrix4,a=o.elements,l=n(e);return a[0]=l.scale[0],a[1]=0,a[2]=l.offset[0]*s,a[3]=0,a[4]=0,a[5]=l.scale[1],a[6]=-l.offset[1]*s,a[7]=0,a[8]=0,a[9]=0,a[10]=i/(r-i)*-s,a[11]=i*r/(r-i),a[12]=0,a[13]=0,a[14]=s,a[15]=0,o.transpose(),o}function o(e,t,r,i){var n=Math.PI/180,o={upTan:Math.tan(e.upDegrees*n),downTan:Math.tan(e.downDegrees*n),leftTan:Math.tan(e.leftDegrees*n),rightTan:Math.tan(e.rightDegrees*n)};return s(o,t,r,i)}var a,l,d,h,u,c,p=!0,v=new THREE.Vector3,f=new THREE.Vector3;navigator.getVRDisplays?navigator.getVRDisplays().then(r):navigator.getVRDevices&&navigator.getVRDevices().then(r),this.isPresenting=!1,this.scale=1;var m=this,g=e.getSize(),y=e.getPixelRatio();this.getVRDisplay=function(){return a},this.getVRDisplays=function(){return l},this.setSize=function(t,r){if(g={width:t,height:r},m.isPresenting){var i=a.getEyeParameters("left");e.setPixelRatio(1),p?e.setSize(2*i.renderWidth,i.renderHeight,!1):e.setSize(2*i.renderRect.width,i.renderRect.height,!1)}else e.setPixelRatio(y),e.setSize(t,r)};var E,w,x,b=e.domElement,R=[0,0,.5,1],_=[.5,0,.5,1];b.requestFullscreen?(E="requestFullscreen",x="fullscreenElement",w="exitFullscreen",document.addEventListener("fullscreenchange",i,!1)):b.mozRequestFullScreen?(E="mozRequestFullScreen",x="mozFullScreenElement",w="mozCancelFullScreen",document.addEventListener("mozfullscreenchange",i,!1)):(E="webkitRequestFullscreen",x="webkitFullscreenElement",w="webkitExitFullscreen",document.addEventListener("webkitfullscreenchange",i,!1)),window.addEventListener("vrdisplaypresentchange",i,!1),this.setFullScreen=function(e){return new Promise(function(t,r){return void 0===a?void r(new Error("No VR hardware found.")):m.isPresenting===e?void t():void(p?t(e?a.requestPresent([{source:b}]):a.exitPresent()):b[E]?(b[e?E:w]({vrDisplay:a}),t()):(console.error("No compatible requestFullscreen method found."),r(new Error("No compatible requestFullscreen method found."))))})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(e){return p&&void 0!==a?a.requestAnimationFrame(e):window.requestAnimationFrame(e)},this.cancelAnimationFrame=function(e){p&&void 0!==a?a.cancelAnimationFrame(e):window.cancelAnimationFrame(e)},this.submitFrame=function(){p&&void 0!==a&&m.isPresenting&&a.submitFrame()},this.autoSubmitFrame=!0;var T=new THREE.PerspectiveCamera;T.layers.enable(1);var V=new THREE.PerspectiveCamera;V.layers.enable(2),this.render=function(t,r,i,n){if(a&&m.isPresenting){var s=t.autoUpdate;s&&(t.updateMatrixWorld(),t.autoUpdate=!1);var l=a.getEyeParameters("left"),g=a.getEyeParameters("right");p?(v.fromArray(l.offset),f.fromArray(g.offset),u=l.fieldOfView,c=g.fieldOfView):(v.copy(l.eyeTranslation),f.copy(g.eyeTranslation),u=l.recommendedFieldOfView,c=g.recommendedFieldOfView),Array.isArray(t)&&(console.warn("THREE.VREffect.render() no longer supports arrays. Use object.layers instead."),t=t[0]);var y=e.getSize();d={x:Math.round(y.width*R[0]),y:Math.round(y.height*R[1]),width:Math.round(y.width*R[2]),height:Math.round(y.height*R[3])},h={x:Math.round(y.width*_[0]),y:Math.round(y.height*_[1]),width:Math.round(y.width*_[2]),height:Math.round(y.height*_[3])},i?(e.setRenderTarget(i),i.scissorTest=!0):e.setScissorTest(!0),(e.autoClear||n)&&e.clear(),null===r.parent&&r.updateMatrixWorld(),T.projectionMatrix=o(u,!0,r.near,r.far),V.projectionMatrix=o(c,!0,r.near,r.far),r.matrixWorld.decompose(T.position,T.quaternion,T.scale),r.matrixWorld.decompose(V.position,V.quaternion,V.scale);var E=this.scale;return T.translateOnAxis(v,E),V.translateOnAxis(f,E),i?(i.viewport.set(d.x,d.y,d.width,d.height),i.scissor.set(d.x,d.y,d.width,d.height)):(e.setViewport(d.x,d.y,d.width,d.height),e.setScissor(d.x,d.y,d.width,d.height)),e.render(t,T,i,n),i?(i.viewport.set(h.x,h.y,h.width,h.height),i.scissor.set(h.x,h.y,h.width,h.height)):(e.setViewport(h.x,h.y,h.width,h.height),e.setScissor(h.x,h.y,h.width,h.height)),e.render(t,V,i,n),i?(i.viewport.set(0,0,y.width,y.height),i.scissor.set(0,0,y.width,y.height),i.scissorTest=!1,e.setRenderTarget(null)):e.setScissorTest(!1),s&&(t.autoUpdate=!0),void(m.autoSubmitFrame&&m.submitFrame())}e.render(t,r,i,n)}}},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={isLatestAvailable:function(){return void 0!==navigator.getVRDisplays},isAvailable:function(){return void 0!==navigator.getVRDisplays||void 0!==navigator.getVRDevices},getMessage:function(){var e;if(navigator.getVRDisplays?navigator.getVRDisplays().then(function(t){0===t.length&&(e="WebVR supported, but no VRDisplays found.")}):e=navigator.getVRDevices?'Your browser supports WebVR but not the latest version. See <a href="http://webvr.info">webvr.info</a> for more info.':'Your browser does not support WebVR. See <a href="http://webvr.info">webvr.info</a> for assistance.',void 0!==e){var t=document.createElement("div");t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.right="0",t.style.zIndex="999",t.align="center";var r=document.createElement("div");return r.style.fontFamily="sans-serif",r.style.fontSize="16px",r.style.fontStyle="normal",r.style.lineHeight="26px",r.style.backgroundColor="#fff",r.style.color="#000",r.style.padding="10px 20px",r.style.margin="50px",r.style.display="inline-block",r.innerHTML=e,t.appendChild(r),t}},getButton:function(e){var t=document.createElement("button");return t.style.position="absolute",t.style.left="calc(50% - 50px)",t.style.bottom="20px",t.style.width="100px",t.style.border="0",t.style.padding="8px",t.style.cursor="pointer",t.style.backgroundColor="#000",t.style.color="#fff",t.style.fontFamily="sans-serif",t.style.fontSize="13px",t.style.fontStyle="normal",t.style.textAlign="center",t.style.zIndex="999",t.textContent="ENTER VR",t.onclick=function(){e.isPresenting?e.exitPresent():e.requestPresent()},window.addEventListener("vrdisplaypresentchange",function(r){t.textContent=e.isPresenting?"EXIT VR":"ENTER VR"},!1),t}}},{}]},{},[1]);
